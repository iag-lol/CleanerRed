<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Aseo - Minimalista</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://apis.google.com/js/api.js" async defer></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.21/jspdf.plugin.autotable.min.js"></script>


</head>

<body>

    <nav class="navbar">
        <h1>CleanerRed</h1>


        <!-- Tarjeta de usuario -->
        <div class="user-card">
            <p><strong>Nombre:</strong> <span id="user-name">Invitado</span></p>
            <p><strong>Estado:</strong> <span id="user-state" class="status-disconnected">Desconectado</span></p>
            <p><strong>Cargo:</strong> <span id="user-position">Sin Asignar</span></p>
        </div>
    </nav>

    <!-- Modal para ingresar nombre y autenticarse -->
    <div id="sessionModal" class="modal">
        <div class="modal-content">
            <h2>Ingrese su nombre completo</h2><br><br><br>
            <input type="text" id="nombreCompleto" placeholder="Nombre Completo" required><br><br><br>
            <button id="saveNameBtn" onclick="saveNameAndProceed()">Guardar</button>
            <button class="close-modal" onclick="closeModal()">Cerrar</button>
        </div>
    </div>


    <br><br><br><br>




    <div class="main-content">
        <header>
            <h1>Registros de Aseos</h1><br><br>
        </header>

        <!-- Dashboard section -->
        <div class="dashboard">
            <div class="card">
                <span id="count-barrido">0</span>
                <h3>Barrido</h3>
            </div>
            <div class="card">
                <span id="count-trapeado">0</span>
                <h3>Trapeado</h3>
            </div>
            <div class="card">
                <span id="count-full">0</span>
                <h3>Full</h3>
            </div>
            <div class="card">
                <span id="count-full-seco">0</span>
                <h3>Full Seco</h3>
            </div>
            <div class="card">
                <span id="count-dtpm">0</span>
                <h3>Preparación DTPM</h3>
            </div>
            <div class="card">
                <span id="count-rtg">0</span>
                <h3>Preparación RTG</h3>
            </div>
            <div class="card">
                <span id="count-applus">0</span>
                <h3>Preparación APPLUS</h3>
            </div>
        </div><br><br>

        <section id="form-section">
            <h2>Registrar Tarea</h2>
            <form id="incident-form">
       <form id="incident-form">
    <!-- PPU con datalist para autocompletar -->
    <input type="text" id="ppu" placeholder="Ingrese PPU" required list="ppu-options">
    <datalist id="ppu-options"></datalist> <!-- Aquí se cargarán las opciones de la flota -->

    <!-- Estado convertido en lista desplegable -->
    <select id="estado" required>
        <option value="" disabled selected>Seleccione Estado</option>
        <option value="OPERATIVO">OPERATIVO</option>
        <option value="PANNE">PANNE</option>
    </select>

    <!-- Labor realizada -->
    <select id="labor" required>
        <option value="Barrido">Barrido</option>
        <option value="Trapeado">Trapeado</option>
        <option value="Full">Full</option>
        <option value="Full Seco">Full Seco</option>
        <option value="Preparacion DTPM">Preparación DTPM</option>
        <option value="Preparacion RTG">Preparación RTG</option>
        <option value="Preparacion APPLUS">Preparación APPLUS</option>
    </select>

    <button type="submit">Registrar Tarea</button><br><br><br>

<!-- Botón Revisar Pendientes -->
<button id="revisarPendientesBtnUnique">Revisar Pendientes</button>

<!-- Modal para mostrar los buses pendientes -->
<div id="pendientesModalUnique" class="modalUnique">
    <div class="modal-contentUnique">
        <h2>Buses Pendientes por Realizar</h2>
        <button class="close-modalUnique" id="closeModalBtnUnique">Cerrar</button>
        <div class="modal-bodyUnique">
            <table id="pendientesTableUnique">
                <thead>
                    <tr>
                        <th>PPU</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Los datos de la hoja FLOTA (columna D) se llenarán aquí -->
                </tbody>
            </table>
        </div>
    </div>
</div>


</form>



        </section><br>

        <section id="form-section">
            <!-- Tabla de tareas -->
            <table id="tasksTable">
                <thead>
                    <tr>
                        <th>PPU</th>
                        <th>Estado</th>
                        <th>Labor</th>
                        <th>Nombre</th>
                        <th>Supervisor</th>
                        <th>Fecha y Hora</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Las tareas se cargarán aquí -->
                </tbody>
            </table>

            <button id="update-button" onclick="loadIncidents()">Actualizar Tabla</button>

            <button id="download-pdf" onclick="downloadPDF()">Descargar en PDF</button>

        </section>
    </div>



    <div id="success-alert" class="alert alert-success">
        <div class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <g stroke-width="0" id="SVGRepo_bgCarrier"></g>
                <g stroke-linejoin="round" stroke-linecap="round" id="SVGRepo_tracerCarrier"></g>
                <g id="SVGRepo_iconCarrier">
                    <path stroke-linejoin="round" stroke-linecap="round" stroke-width="1.5" stroke="#000000"
                        d="M20 7L9.00004 18L3.99994 13"></path>
                </g>
            </svg>
        </div>
        <div class="message">Registro realizado con éxito.</div>
    </div>




    <script src="main.js"></script>
</body>

</html>
